<figure class="l-body grid">
  
<div class="grid row">
  <h4>Content Image</h4>
  <h4>Style Image</h4>
</div>

<div class="grid row">
  
  <div class="grid">
    <div id="icons-first" class="icons-column">
      <div class="icons">
        {{#each contentImages as contentImage, i}}
          <div class="icon {{(contentIndex == i)? 'selected' : ''}}" on:click='set({contentIndex: i})'>
            <div style="background-image: url({{contentImage.src}})"></div>
          </div>
        {{/each}}
      </div>
    </div>
    
    <div id="sprite-first" class="sprite">
      <div style="background-image: url({{contentImage.src}})"></div>
      <span class="figcaption">Photograph by {{contentImage.artist}}</span>
    </div>
  </div>
  
  <div class="grid">
    <div id="icons-second" class="icons-column">
      <div class="icons">
        {{#each styleImages as styleImage, i}}
          <div class="icon {{(styleIndex == i)? 'selected' : ''}}" on:click='set({styleIndex: i})'>
            <div style="background-image: url({{styleImage.src}})" class="{{styleImage.rotated? 'rotated' : ''}}"></div>
          </div>
        {{/each}}
      </div>
    </div>
    
    <div id="sprite-second" class="sprite">
      <div style="background-image: url({{styleImage.src}})" class="{{styleImage.rotated? 'rotated' : ''}}"></div>
      <span class="figcaption">"{{styleImage.title}}" (<em>{{styleImage.artist}}</em>, {{styleImage.year}})</span>
    </div>
  </div>

</div>

<div class="grid row">
  <ImageComparison id="image-comparison" left={{styletransferImages[0]}} right={{styletransferImages[1]}}></ImageComparison>
</div>

<div class="grid row"><span class="figcaption">
  Styletransfer of "{{styleImage.title}}" (<em>{{styleImage.artist}}</em>, {{styleImage.year}}) onto "{{contentImage.title}}" by {{contentImage.artist}}.
</span></div>

</figure>


<style>

.grid {
  display: grid;
  grid-auto-flow: row;
  grid-gap: 10px;
  grid-auto-columns: 1fr;
}

.row {
  grid-auto-flow: column;
}

h4 {
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: 8px;
  margin: 0;
  font-weight: 700;
}


.captions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-column-gap: 10px;
}

.caption {
  margin-bottom: 10px;
}

.caption-first {
  text-align: right;
}


/* Icons */
.icons {
  grid-column: min-content;
  display: flex;
  flex-wrap: wrap;
  flex-direction: row;
  justify-content: space-between;
  /* margin-bottom: 7px; */
  max-width: calc(49px * 6);
  /*border-bottom: 1px solid #dddddd;*/
}
.icons .icon {
  cursor: pointer;
  padding-bottom: 6px;
  /*margin-left: 3px;*/
  /* margin-right: 6px; */
  border-bottom: 1px solid #dddddd;
}
.icons .icon.selected {
  opacity: 100%;
  padding-bottom: 3px;
  border-bottom: 3px solid #ff6600;
}
.icon div {
  opacity: 0.5;
  image-rendering: auto;
  width: 44px;
  height: 44px;
  background-size: cover;
  background-position: center;
}
.icon.selected div {
  opacity: 1;
}
/* -end Icons end- */
.sprite span {

}
.sprite div {
  /* flex: 1 1; */
  position: relative;
  /* width: 1vw; */
  /* height: 10vw; */
  /* height: 0; */
  /* padding-top: 100%; */
  background-size: cover;
  background-position: center;
  /* object-fit: contain; */
}
.sprite div:before {
  content: "";
	display: block;
	padding-top: 100%;
}
.icons-column {
  /* grid-column: min-content; */
}
.rotated {
  transform: rotate(90deg);
}
</style>

<script>
  import { range } from '../util';
  import ImageComparison from '../components/ImageComparison'

  function canonical_name_part(url) {
    const basename = url.split('/').pop();
    return basename.replace('-cropped', '').replace('.jpg', '')
  }

  export default {
    components: { ImageComparison },
    computed: {
      contentImage: (contentImages, contentIndex) => contentImages[contentIndex],
      styleImage: (styleImages, styleIndex) => styleImages[styleIndex],
      styletransferImages: (contentImage, styleImage) => {
        const styleNamePart = canonical_name_part(styleImage.src);
        const contentNamePart = canonical_name_part(contentImage.src);
        const basename = styleNamePart + '-' + contentNamePart;
        const folderName = 'images/styletransfer/';
        const decorrelatedURL = folderName + basename + '-decorrelated.jpg';
        const correlatedURL = folderName + basename + '.jpg';
        return [decorrelatedURL, correlatedURL];
      }
    },
    data() {
      return {
        contentIndex: 0,
        styleIndex: 0,
        contentImages: [
          {
            src: 'images/content/food.jpg',
            title: 'Food',
            artist: 'Brooke Lark'
          },
          {
            src: 'images/content/girl.jpg',
            title: 'Girl',
            artist: 'Diana Feil'
          },
          {
            src: 'images/content/architecture.jpg',
            title: 'Architecture',
            artist: 'Petr Kratochvil'
          },
          {
            src: 'images/content/bridge.jpg',
            title: 'Bridge',
            artist: 'Public Domain'
          },
          {
            src: 'images/content/utah.jpg',
            title: 'Utah',
            artist: 'Alex Povolyashko'
          },
          {
            src: 'images/content/zurich.jpg',
            title: 'Zurich',
            artist: 'Andyindia'
          },
        ],
        styleImages: [
          {
            src: 'images/styles/woman-cropped.jpg',
            title: 'Woman with a Hat',
            artist: 'Henri Matisse',
            year: 1905,
            rotated: true
          },
          {
            src: 'images/styles/starry-night-cropped.jpg',
            title: 'Starry Night',
            artist: 'Vincent van Gogh',
            year: 1889,
            rotated: false
          },
          {
            src: 'images/styles/composition-cropped.jpg',
            title: 'Composition VII',
            artist: 'Wassily Kandinsky',
            year: 1913,
            rotated: false
          },
          {
            src: 'images/styles/picasso-cropped.jpg',
            title: 'Self-Portrait',
            artist: 'Pablo Picasso',
            year: 1907,
            rotated: true
          },
          {
            src: 'images/styles/scream-cropped.jpg',
            title: 'The Scream',
            artist: 'Edvard Munch',
            year: 1893,
            rotated: true
          },
          {
            src: 'images/styles/wave-cropped.jpg',
            title: 'The Great Wave off Kanagawa',
            artist: 'Katsushika Hokusai',
            year: 1831,
            rotated: false
          },
          // { 
          //   src: 'images/styles/parade-cropped.jpg', 
          //   title: 'The large one parades on red bottom', 
          //   artist: 'Fernand Leger',
          //   year: 1953,
          //   rotated: false
          // },
        ]
      };
    },
    helpers: {
      range,
    }
  }
</script>
